<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>íƒ€ì„í…Œì´ë¸”</title>

  <!-- PWA ì„¤ì • -->
  <link rel="manifest" href="manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f9f9f9;
    }

    h2 {
      color: #3f51b5;
    }

    .controls {
      margin-bottom: 20px;
    }

    input, select {
      font-size: 16px;
      padding: 6px;
      margin-right: 8px;
    }

    #container {
      position: relative;
      width: 360px;
      height: 360px;
      margin-top: 30px;
    }

    #square {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 1fr 1fr;
      width: 320px;
      height: 320px;
      border: 4px solid #3f51b5;
      position: absolute;
      top: 20px;
      left: 20px;
    }

    .corner {
      padding: 8px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }

    .top-left { align-items: flex-start; }
    .top-right { align-items: flex-end; }
    .bottom-right { align-items: flex-end; justify-content: flex-end; }
    .bottom-left { justify-content: flex-end; }

    .time {
      background-color: #e3f2fd;
      border: 1px solid #90caf9;
      border-radius: 12px;
      padding: 6px 12px;
      margin: 4px;
      font-size: 16px;
    }

    .expired {
      color: gray;
      background-color: #eee;
      text-decoration: line-through;
    }

    .main-highlight {
      background-color: #ffebee;
      color: #d32f2f;
      border-color: #d32f2f;
    }

    button {
      position: absolute;
      padding: 6px 12px;
      border: 2px solid #3f51b5;
      background: white;
      border-radius: 6px;
      cursor: pointer;
    }

    .btn-tl { top: 0; left: 0; transform: translate(-100%, -100%); }
    .btn-tr { top: 0; right: 0; transform: translate(100%, -100%); }
    .btn-br { bottom: 0; right: 0; transform: translate(100%, 100%); }
    .btn-bl { bottom: 0; left: 0; transform: translate(-100%, 100%); }
  </style>
</head>

<body>
  <h2>ğŸ“‹ íƒ€ì„í…Œì´ë¸”</h2>

  <div class="controls">
    <input id="startTime" placeholder="0800" maxlength="4">
    <select id="startCorner">
      <option value="0">ì¢Œìƒ</option>
      <option value="1">ìš°ìƒ</option>
      <option value="2">ìš°í•˜</option>
      <option value="3">ì¢Œí•˜</option>
    </select>
  </div>

  <div id="container">
    <div id="square">
      <div class="corner top-left" id="c0"></div>
      <div class="corner top-right" id="c1"></div>
      <div class="corner bottom-right" id="c2"></div>
      <div class="corner bottom-left" id="c3"></div>
    </div>

    <button class="btn-tl" onclick="toggle(0)">ì…êµ¬</button>
    <button class="btn-tr" onclick="toggle(1)">ì…êµ¬</button>
    <button class="btn-br" onclick="toggle(2)">ì…êµ¬</button>
    <button class="btn-bl" onclick="toggle(3)">ì…êµ¬</button>
  </div>

  <script>
    const order = [
      [0,1,2,3],
      [1,2,3,0],
      [2,3,0,1],
      [3,0,1,2]
    ];

    const input = document.getElementById("startTime");
    const select = document.getElementById("startCorner");

    function draw() {
      const v = input.value;
      if (v.length !== 4) return;

      const h = parseInt(v.slice(0,2));
      const m = parseInt(v.slice(2,4));
      if (h > 23 || m > 59) return;

      document.querySelectorAll(".corner").forEach(c => c.innerHTML = "");

      let t = new Date();
      t.setHours(h, m, 0, 0);

      const now = new Date();
      const end = new Date();
      end.setHours(18,0,0,0);

      let i = 0;
      while (t <= end) {
        const span = document.createElement("div");
        span.className = "time";
        span.innerText = t.toTimeString().slice(0,5);
        if (t < now) span.classList.add("expired");

        document.getElementById("c" + order[select.value][i % 4]).appendChild(span);
        t = new Date(t.getTime() + 40 * 60000);
        i++;
      }
    }

    function toggle(i) {
      document.querySelectorAll("#c"+i+" .time")
        .forEach(e => e.classList.toggle("main-highlight"));
    }

    input.addEventListener("input", draw);
    select.addEventListener("change", draw);

    setInterval(draw, 60000);

    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("service-worker.js");
    }
  </script>
</body>
</html>
